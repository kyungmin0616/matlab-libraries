%==========================================================
%	% grid file sub extract
%==========================================================
grd=rnt_gridload('nepd');
sub_I=137:266;
sub_J=10:139;
filename='/drive/edl/NEPD/nepd-data/nepd-ccs-grid.nc';
rgrd_SubGridEx(grd,sub_I,sub_J,filename);


%==========================================================
%	% forcing files sub extract
%==========================================================
forc_timevars= ...
    {'shf_time' 'srf_time' 'swf_time'  'sms_time'  ...
     'sms_time' 'sst_time' 'sst_time'  'sss_time' };

forc_vars= ...
    {'shflux'   'swrad'    'swflux' 'sustr' ...
     'svstr'    'SST'      'dQdSST' 'SSS' };

% forcing info
forcfile='/drive/edl/NEPD/nepd-data/nepd-forc-winds-50yr+RSM.nc';
forcfileo='/drive/edl/NEPD/nepd-data/nepd-ccs-forc-winds-50yr+RSM.nc';
in=[4 5];
rnc_SubForcEx(forcfile,grd,forcfileo,grdo, ...
         sub_I,sub_J,forc_timevars(in),forc_vars(in));
	   	  

forcfile='/drive/edl/NEPD/nepd-data/nepd-forc-heat-fresh-CLIMA-noSST.nc';
forcfileo='/drive/edl/NEPD/nepd-data/nepd-ccs-forc-heat-fresh-CLIMA-noSST.nc';
in=[1 2 3 8];
rnc_SubForcEx(forcfile,grd,forcfileo,grdo, ...
         sub_I,sub_J,forc_timevars(in),forc_vars(in));


forcfile='/drive/edl/NEPD/nepd-data/nepd-forc-SST-50yr.nc';
forcfileo='/drive/edl/NEPD/nepd-data/nepd-ccs-forc-SST-50yr.nc';
in=[6 7];
rnc_SubForcEx(forcfile,grd,forcfileo,grdo, ...
         sub_I,sub_J,forc_timevars(in),forc_vars(in));





% open output files
files=rnt_getfilenames('/neo/NEPD/forc_full_bio/rst1/avg','avg');
% get ocean time
ctl=rnt_timectl(files,'ocean_time','r');
for i=1:length(ctl.time)
	mydate(i)=datenum(ctl.year(i)+1950, ctl.month(i),ctl.day(i));
end
ctl.mydate=mydate;

timeind=292; dt=3;
timeind_range=timeind-1:timeind+dt+1;


% INPUTS
grdo=rnt_gridload('nepd-ccs');
bryfile='/drive/edl/NEPD/passive/nepd-ccs-bry.nc';
optbry.npzd=1;
optbry.bry_time = length(timeind_range);
optbry.bry_time_cycle=0;
optbry.ptracer = 0;
optbry.bry_timeVal = ctl.time(timeind_range)/60/60/24;

inifile='/drive/edl/NEPD/passive/nepd-ccs-ini.nc';
optini.npzd=1;
vars={'salt' 'temp' 'u' 'v' 'ubar' 'vbar' 'zeta' ...
       'detritus' 'phytoplankton' 'zooplankton' 'NO3'};


rnc_Sub_Ini_Bry(ctl,grd,timeind_range,vars,grdo, ... 
          sub_I,sub_J,bryfile,optbry,inifile,optini,timeind)










clf
rnt_plc3(grd.h,grd,0,7,0,0);
rnt_gridbox(grd2);

































































































































































































































































































































































































































































































































































































































































































































































